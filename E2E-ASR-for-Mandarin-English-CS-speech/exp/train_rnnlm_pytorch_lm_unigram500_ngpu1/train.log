# lm_train.py --config conf/lm.yaml --ngpu 1 --backend pytorch --verbose 1 --outdir exp/train_rnnlm_pytorch_lm_unigram500_ngpu1 --tensorboard-dir tensorboard/train_rnnlm_pytorch_lm_unigram500_ngpu1 --train-label data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/train.txt --valid-label data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/valid.txt --test-label data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/test.txt --resume --dict data/lang_char/train_3w_200ENZH_unigram500CE_F3_se500_units.txt --dump-hdf5-path data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500 
# Started at Tue Jul 16 15:59:37 CEST 2024
#
2024-07-16 16:00:17,842 (lm_train:254) INFO: ngpu: 1
2024-07-16 16:00:17,842 (lm_train:257) INFO: python path = /mount/arbeitsdaten/asr/licu/Experiments/Semi-supervised_ASR/E2E2022/tools/s3prl:
2024-07-16 16:00:17,851 (lm_train:274) INFO: backend = pytorch
2024-07-16 16:00:17,981 (lm:217) INFO: torch version = 1.10.1
2024-07-16 16:00:18,016 (deterministic_utils:26) INFO: torch type check is disabled
2024-07-16 16:00:18,051 (lm_utils:45) INFO: reading text dataset: data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/valid.txt
0it [00:00, ?it/s]6614it [00:00, 81298.63it/s]
2024-07-16 16:00:18,170 (lm_utils:49) INFO: saving binary dataset: data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/valid.txt.h5
2024-07-16 16:00:18,205 (lm_utils:45) INFO: reading text dataset: data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/train.txt
0it [00:00, ?it/s]9557it [00:00, 95553.69it/s]20535it [00:00, 103913.42it/s]32680it [00:00, 111913.45it/s]43872it [00:00, 101587.24it/s]54159it [00:00, 98977.34it/s] 64137it [00:00, 94265.03it/s]73776it [00:00, 94899.91it/s]83319it [00:00, 90598.60it/s]92436it [00:00, 85672.65it/s]101906it [00:01, 88214.37it/s]111761it [00:01, 91162.53it/s]121843it [00:01, 93968.66it/s]131691it [00:01, 95290.74it/s]141598it [00:01, 96404.29it/s]151604it [00:01, 97481.00it/s]161459it [00:01, 97796.02it/s]171367it [00:01, 98177.08it/s]181321it [00:01, 98581.14it/s]191257it [00:01, 98795.87it/s]201195it [00:02, 98969.02it/s]211097it [00:02, 98980.22it/s]223022it [00:02, 105051.91it/s]236229it [00:02, 113149.31it/s]243357it [00:02, 99828.00it/s] 
2024-07-16 16:00:21,209 (lm_utils:49) INFO: saving binary dataset: data/local/lm_seametrain_aishell_sms_CCG_B2A2B0.7_A2B2A0_ep10_unigram500/train.txt.h5
2024-07-16 16:00:21,948 (lm:235) INFO: #vocab = 4719
2024-07-16 16:00:21,949 (lm:236) INFO: #sentences in the training data = 243357
2024-07-16 16:00:21,949 (lm:237) INFO: #tokens in the training data = 6494634
2024-07-16 16:00:21,949 (lm:238) INFO: oov rate in the training data = 0.10 %
2024-07-16 16:00:21,949 (lm:242) INFO: #sentences in the validation data = 6614
2024-07-16 16:00:21,949 (lm:243) INFO: #tokens in the validation data = 151755
2024-07-16 16:00:21,949 (lm:244) INFO: oov rate in the validation data = 0.00 %
2024-07-16 16:00:22,122 (lm:268) INFO: #iterations per epoch = 1117
2024-07-16 16:00:22,122 (lm:269) INFO: #total iterations = 55850
2024-07-16 16:00:22,475 (default:377) INFO: Tie weights set to False
2024-07-16 16:00:22,475 (default:378) INFO: Dropout set to 0.5
2024-07-16 16:00:22,475 (default:379) INFO: Emb Dropout set to 0.0
2024-07-16 16:00:48,410 (lm:285) INFO: writing a model config file to exp/train_rnnlm_pytorch_lm_unigram500_ngpu1/model.json
2024-07-16 16:00:48,434 (lm:292) WARNING: num. model params: 12,909,819 (num. trained: 12,909,819 (100.0%))
epoch       iteration   main/loss   perplexity  val_perplexity  elapsed_time
[J0           100         207.935     810.498                     16.842        
[J     total [..................................................]  0.18%
this epoch [####..............................................]  8.95%
       100 iter, 0 epoch / 50 epochs
       inf iters/sec. Estimated time to finish: 0:00:00.
[4A[J0           200         165.735     220.04                      27.3393       
[J     total [..................................................]  0.36%
this epoch [########..........................................] 17.91%
       200 iter, 0 epoch / 50 epochs
    9.5631 iters/sec. Estimated time to finish: 1:36:59.264121.
[4A[J0           300         149.343     107.965                     37.9972       
[J     total [..................................................]  0.54%
this epoch [#############.....................................] 26.86%
       300 iter, 0 epoch / 50 epochs
    9.4723 iters/sec. Estimated time to finish: 1:37:44.493981.
[4A[J0           400         154.38      94.8242                     49.1739       
[J     total [..................................................]  0.72%
this epoch [#################.................................] 35.81%
       400 iter, 0 epoch / 50 epochs
      9.29 iters/sec. Estimated time to finish: 1:39:28.802251.
[4A[J0           500         145.885     82.2991                     60.3892       
[J     total [..................................................]  0.90%
this epoch [######################............................] 44.76%
       500 iter, 0 epoch / 50 epochs
    9.1938 iters/sec. Estimated time to finish: 1:40:20.337503.
[4A[J0           600         138.622     79.6004                     70.9738       
[J     total [..................................................]  1.07%
this epoch [##########################........................] 53.72%
       600 iter, 0 epoch / 50 epochs
    9.2438 iters/sec. Estimated time to finish: 1:39:36.968938.
[4A[J0           700         133.508     65.2039                     81.4942       
[J     total [..................................................]  1.25%
this epoch [###############################...................] 62.67%
       700 iter, 0 epoch / 50 epochs
    9.2863 iters/sec. Estimated time to finish: 1:38:58.864178.
[4A[J0           800         122.723     55.9324                     91.7959       
[J     total [..................................................]  1.43%
this epoch [###################################...............] 71.62%
       800 iter, 0 epoch / 50 epochs
    9.3442 iters/sec. Estimated time to finish: 1:38:11.349134.
[4A[J0           900         126.817     51.3943                     102.38        
[J     total [..................................................]  1.61%
this epoch [########################################..........] 80.57%
       900 iter, 0 epoch / 50 epochs
     9.357 iters/sec. Estimated time to finish: 1:37:52.602322.
[4A[J0           1000        128.868     43.7664                     113.561       
[J     total [..................................................]  1.79%
this epoch [############################################......] 89.53%
      1000 iter, 0 epoch / 50 epochs
    9.3092 iters/sec. Estimated time to finish: 1:38:11.997213.
[4A[J0           1100        117.353     38.4449                     124.879       
[J     total [..................................................]  1.97%
this epoch [#################################################.] 98.48%
      1100 iter, 0 epoch / 50 epochs
    9.2596 iters/sec. Estimated time to finish: 1:38:32.761266.
[4A2024-07-16 16:03:00,438 (lm_utils:255) INFO: best model is rnnlm.model.1
[J1           1200        113.285     34.4332     21.0414         137.741       
[J     total [#.................................................]  2.15%
this epoch [###...............................................]  7.43%
      1200 iter, 1 epoch / 50 epochs
    9.1015 iters/sec. Estimated time to finish: 1:40:04.508057.
[4A[J1           1300        101.621     32.2573                     148.192       
[J     total [#.................................................]  2.33%
this epoch [########..........................................] 16.38%
      1300 iter, 1 epoch / 50 epochs
    9.1387 iters/sec. Estimated time to finish: 1:39:29.097841.
[4A[J1           1400        108.07      28.0832                     159.221       
[J     total [#.................................................]  2.51%
this epoch [############......................................] 25.34%
      1400 iter, 1 epoch / 50 epochs
    9.1331 iters/sec. Estimated time to finish: 1:39:21.827540.
[4A[J1           1500        111.429     26.5029                     170.716       
[J     total [#.................................................]  2.69%
this epoch [#################.................................] 34.29%
      1500 iter, 1 epoch / 50 epochs
       9.1 iters/sec. Estimated time to finish: 1:39:32.527977.
[4A[J1           1600        107.085     25.8589                     182.173       
[J     total [#.................................................]  2.86%
this epoch [#####################.............................] 43.24%
      1600 iter, 1 epoch / 50 epochs
    9.0748 iters/sec. Estimated time to finish: 1:39:38.073094.
[4A[J1           1700        97.4719     24.6551                     192.675       
[J     total [#.................................................]  3.04%
this epoch [##########################........................] 52.19%
      1700 iter, 1 epoch / 50 epochs
    9.1016 iters/sec. Estimated time to finish: 1:39:09.483377.
[4A[J1           1800        102.765     23.705                      203.481       
[J     total [#.................................................]  3.22%
this epoch [##############################....................] 61.15%
      1800 iter, 1 epoch / 50 epochs
    9.1105 iters/sec. Estimated time to finish: 1:38:52.711603.
[4A[J1           1900        96.4482     21.7665                     214.074       
[J     total [#.................................................]  3.40%
this epoch [###################################...............] 70.10%
      1900 iter, 1 epoch / 50 epochs
    9.1282 iters/sec. Estimated time to finish: 1:38:30.238316.
[4A[J1           2000        95.6552     22.0272                     224.433       
[J     total [#.................................................]  3.58%
this epoch [#######################################...........] 79.05%
      2000 iter, 1 epoch / 50 epochs
    9.1544 iters/sec. Estimated time to finish: 1:38:02.408399.
[4A[J1           2100        104.438     20.8435                     235.71        
[J     total [#.................................................]  3.76%
this epoch [############################################......] 88.00%
      2100 iter, 1 epoch / 50 epochs
    9.1396 iters/sec. Estimated time to finish: 1:38:00.982882.
[4A[J1           2200        93.5157     20.6988                     246.418       
[J     total [#.................................................]  3.94%
this epoch [################################################..] 96.96%
      2200 iter, 1 epoch / 50 epochs
    9.1489 iters/sec. Estimated time to finish: 1:37:44.075914.
[4A2024-07-16 16:05:04,021 (lm_utils:255) INFO: best model is rnnlm.model.2
[J2           2300        98.739      20.2763     13.3657         259.24        
[J     total [##................................................]  4.12%
this epoch [##................................................]  5.91%
      2300 iter, 2 epoch / 50 epochs
    9.0775 iters/sec. Estimated time to finish: 1:38:19.210727.
[4A[J2           2400        88.2704     19.642                      269.602       
[J     total [##................................................]  4.30%
this epoch [#######...........................................] 14.86%
      2400 iter, 2 epoch / 50 epochs
     9.101 iters/sec. Estimated time to finish: 1:37:53.007633.
[4A[J2           2500        96.8724     18.7621                     280.694       
[J     total [##................................................]  4.48%
this epoch [###########.......................................] 23.81%
      2500 iter, 2 epoch / 50 epochs
    9.0974 iters/sec. Estimated time to finish: 1:37:44.313763.
[4A[J2           2600        96.2432     18.0192                     291.745       
[J     total [##................................................]  4.66%
this epoch [################..................................] 32.77%
      2600 iter, 2 epoch / 50 epochs
    9.0954 iters/sec. Estimated time to finish: 1:37:34.578242.
[4A[J2           2700        97.9788     18.6691                     303.29        
[J     total [##................................................]  4.83%
this epoch [####################..............................] 41.72%
      2700 iter, 2 epoch / 50 epochs
     9.078 iters/sec. Estimated time to finish: 1:37:34.817442.
[4A[J2           2800        87.9027     18.048                      313.751       
[J     total [##................................................]  5.01%
this epoch [#########################.........................] 50.67%
      2800 iter, 2 epoch / 50 epochs
    9.0949 iters/sec. Estimated time to finish: 1:37:12.928724.
[4A[J2           2900        92.2471     17.9185                     324.304       
[J     total [##................................................]  5.19%
this epoch [#############################.....................] 59.62%
      2900 iter, 2 epoch / 50 epochs
     9.108 iters/sec. Estimated time to finish: 1:36:53.568722.
[4A[J2           3000        90.5424     17.4072                     334.804       
[J     total [##................................................]  5.37%
this epoch [##################################................] 68.58%
      3000 iter, 2 epoch / 50 epochs
    9.1218 iters/sec. Estimated time to finish: 1:36:33.840913.
[4A[J2           3100        84.6159     17.4991                     344.778       
[J     total [##................................................]  5.55%
this epoch [######################################............] 77.53%
      3100 iter, 2 epoch / 50 epochs
    9.1492 iters/sec. Estimated time to finish: 1:36:05.501814.
[4A[J2           3200        97.1626     16.9015                     355.902       
[J     total [##................................................]  5.73%
this epoch [###########################################.......] 86.48%
      3200 iter, 2 epoch / 50 epochs
     9.144 iters/sec. Estimated time to finish: 1:35:57.860962.
[4A[J2           3300        92.8726     17.4729                     366.687       
[J     total [##................................................]  5.91%
this epoch [###############################################...] 95.43%
      3300 iter, 2 epoch / 50 epochs
     9.148 iters/sec. Estimated time to finish: 1:35:44.445438.
[4A2024-07-16 16:07:05,981 (lm_utils:255) INFO: best model is rnnlm.model.3
[J3           3400        90.5994     16.8173     12.3507         379.38        
[J     total [###...............................................]  6.09%
this epoch [##................................................]  4.39%
      3400 iter, 3 epoch / 50 epochs
    9.1035 iters/sec. Estimated time to finish: 1:36:01.511487.
[4A[J3           3500        84.7846     17.065                      389.574       
[J     total [###...............................................]  6.27%
this epoch [######............................................] 13.34%
      3500 iter, 3 epoch / 50 epochs
    9.1228 iters/sec. Estimated time to finish: 1:35:38.340896.
[4A[J3           3600        90.608      16.1016                     400.406       
[J     total [###...............................................]  6.45%
this epoch [###########.......................................] 22.29%
      3600 iter, 3 epoch / 50 epochs
    9.1259 iters/sec. Estimated time to finish: 1:35:25.464481.
[4A[J3           3700        87.8432     15.9888                     411.009       
[J     total [###...............................................]  6.62%
this epoch [###############...................................] 31.24%
      3700 iter, 3 epoch / 50 epochs
    9.1341 iters/sec. Estimated time to finish: 1:35:09.370154.
[4A[J3           3800        94.4183     15.9712                     422.263       
[J     total [###...............................................]  6.80%
this epoch [####################..............................] 40.20%
      3800 iter, 3 epoch / 50 epochs
    9.1272 iters/sec. Estimated time to finish: 1:35:02.714443.
[4A[J3           3900        89.4816     16.1656                     433.164       
[J     total [###...............................................]  6.98%
this epoch [########################..........................] 49.15%
      3900 iter, 3 epoch / 50 epochs
    9.1284 iters/sec. Estimated time to finish: 1:34:51.006689.
[4A[J3           4000        87.0367     16.1157                     443.448       
[J     total [###...............................................]  7.16%
this epoch [#############################.....................] 58.10%
      4000 iter, 3 epoch / 50 epochs
     9.142 iters/sec. Estimated time to finish: 1:34:31.615937.
[4A[J3           4100        89.188      15.7935                     454.452       
[J     total [###...............................................]  7.34%
this epoch [#################################.................] 67.05%
      4100 iter, 3 epoch / 50 epochs
    9.1414 iters/sec. Estimated time to finish: 1:34:21.054903.
[4A[J3           4200        80.6105     15.7158                     464.367       
[J     total [###...............................................]  7.52%
this epoch [######################################............] 76.01%
      4200 iter, 3 epoch / 50 epochs
    9.1623 iters/sec. Estimated time to finish: 1:33:57.211267.
[4A[J3           4300        92.3658     15.7128                     475.549       
[J     total [###...............................................]  7.70%
this epoch [##########################################........] 84.96%
      4300 iter, 3 epoch / 50 epochs
     9.157 iters/sec. Estimated time to finish: 1:33:49.571419.
[4A[J3           4400        94.5843     15.658                      486.706       
[J     total [###...............................................]  7.88%
this epoch [##############################################....] 93.91%
      4400 iter, 3 epoch / 50 epochs
    9.1524 iters/sec. Estimated time to finish: 1:33:41.498130.
[4A2024-07-16 16:09:07,502 (lm_utils:255) INFO: best model is rnnlm.model.4
[J4           4500        88.3799     15.5346     11.3519         499.364       
[J     total [####..............................................]  8.06%
this epoch [#.................................................]  2.86%
      4500 iter, 4 epoch / 50 epochs
    9.1195 iters/sec. Estimated time to finish: 1:33:50.797142.
[4A[J4           4600        80.5904     15.918                      509.428       
[J     total [####..............................................]  8.24%
this epoch [#####.............................................] 11.82%
      4600 iter, 4 epoch / 50 epochs
    9.1362 iters/sec. Estimated time to finish: 1:33:29.542874.
[4A[J4           4700        85.5331     14.9071                     520.094       
[J     total [####..............................................]  8.42%
this epoch [##########........................................] 20.77%
      4700 iter, 4 epoch / 50 epochs
    9.1413 iters/sec. Estimated time to finish: 1:33:15.495295.
[4A[J4           4800        81.4291     14.8033                     530.424       
[J     total [####..............................................]  8.59%
this epoch [##############....................................] 29.72%
      4800 iter, 4 epoch / 50 epochs
    9.1521 iters/sec. Estimated time to finish: 1:32:57.938979.
[4A[J4           4900        94.6398     14.7375                     541.875       
[J     total [####..............................................]  8.77%
this epoch [###################...............................] 38.68%
      4900 iter, 4 epoch / 50 epochs
     9.143 iters/sec. Estimated time to finish: 1:32:52.585997.
[4A[J4           5000        92.0658     15.3432                     553.267       
[J     total [####..............................................]  8.95%
this epoch [#######################...........................] 47.63%
      5000 iter, 4 epoch / 50 epochs
    9.1352 iters/sec. Estimated time to finish: 1:32:46.360396.
[4A[J4           5100        82.8882     15.1073                     563.545       
[J     total [####..............................................]  9.13%
this epoch [############################......................] 56.58%
      5100 iter, 4 epoch / 50 epochs
    9.1464 iters/sec. Estimated time to finish: 1:32:28.628268.
[4A[J4           5200        92.3237     15.1289                     574.573       
[J     total [####..............................................]  9.31%
this epoch [################################..................] 65.53%
      5200 iter, 4 epoch / 50 epochs
    9.1449 iters/sec. Estimated time to finish: 1:32:18.631043.
[4A[J4           5300        75.8334     14.5023                     584.089       
[J     total [####..............................................]  9.49%
this epoch [#####################################.............] 74.49%
      5300 iter, 4 epoch / 50 epochs
    9.1677 iters/sec. Estimated time to finish: 1:31:53.909275.
[4A[J4           5400        88.2045     14.9732                     594.903       
[J     total [####..............................................]  9.67%
this epoch [#########################################.........] 83.44%
      5400 iter, 4 epoch / 50 epochs
    9.1692 iters/sec. Estimated time to finish: 1:31:42.097390.
[4A[J4           5500        93.2084     14.8969                     606.095       
[J     total [####..............................................]  9.85%
this epoch [##############################################....] 92.39%
      5500 iter, 4 epoch / 50 epochs
    9.1648 iters/sec. Estimated time to finish: 1:31:33.861948.
[4A2024-07-16 16:11:08,771 (lm_utils:255) INFO: best model is rnnlm.model.5
[J5           5600        86.6749     14.7469     10.9692         618.708       
[J     total [#####.............................................] 10.03%
this epoch [..................................................]  1.34%
      5600 iter, 5 epoch / 50 epochs
    9.1389 iters/sec. Estimated time to finish: 1:31:38.503419.
[4A[J5           5700        78.9055     15.0543                     628.702       
[J     total [#####.............................................] 10.21%
this epoch [#####.............................................] 10.30%
      5700 iter, 5 epoch / 50 epochs
     9.153 iters/sec. Estimated time to finish: 1:31:19.076477.
[4A[J5           5800        81.6383     14.406                      639.11        
[J     total [#####.............................................] 10.38%
this epoch [#########.........................................] 19.25%
      5800 iter, 5 epoch / 50 epochs
    9.1606 iters/sec. Estimated time to finish: 1:31:03.600538.
[4A[J5           5900        84.5175     14.1897                     649.888       
[J     total [#####.............................................] 10.56%
this epoch [##############....................................] 28.20%
      5900 iter, 5 epoch / 50 epochs
    9.1626 iters/sec. Estimated time to finish: 1:30:51.491525.
[4A[J5           6000        91.1247     14.2334                     661.283       
[J     total [#####.............................................] 10.74%
this epoch [##################................................] 37.15%
      6000 iter, 5 epoch / 50 epochs
    9.1558 iters/sec. Estimated time to finish: 1:30:44.651427.
[4A[J5           6100        91.5971     14.2205                     672.749       
[J     total [#####.............................................] 10.92%
this epoch [#######################...........................] 46.11%
      6100 iter, 5 epoch / 50 epochs
    9.1482 iters/sec. Estimated time to finish: 1:30:38.241382.
[4A[J5           6200        78.9637     14.7858                     682.847       
[J     total [#####.............................................] 11.10%
this epoch [###########################.......................] 55.06%
      6200 iter, 5 epoch / 50 epochs
    9.1596 iters/sec. Estimated time to finish: 1:30:20.522769.
[4A[J5           6300        88.4384     14.4587                     693.631       
[J     total [#####.............................................] 11.28%
this epoch [################################..................] 64.01%
      6300 iter, 5 epoch / 50 epochs
    9.1614 iters/sec. Estimated time to finish: 1:30:08.550662.
[4A[J5           6400        80.9805     14.0855                     703.826       
[J     total [#####.............................................] 11.46%
this epoch [####################################..............] 72.96%
      6400 iter, 5 epoch / 50 epochs
     9.171 iters/sec. Estimated time to finish: 1:29:51.973916.
[4A[J5           6500        83.7208     14.4425                     714.302       
[J     total [#####.............................................] 11.64%
this epoch [########################################..........] 81.92%
      6500 iter, 5 epoch / 50 epochs
    9.1767 iters/sec. Estimated time to finish: 1:29:37.757114.
[4A[J5           6600        93.7649     14.1279                     725.682       
[J     total [#####.............................................] 11.82%
this epoch [#############################################.....] 90.87%
      6600 iter, 5 epoch / 50 epochs
    9.1704 iters/sec. Estimated time to finish: 1:29:30.522294.
[4A[J5           6700        84.0043     14.1949                     736.444       
[J     total [#####.............................................] 12.00%
this epoch [#################################################.] 99.82%
      6700 iter, 5 epoch / 50 epochs
    9.1722 iters/sec. Estimated time to finish: 1:29:18.558572.
[4A[J6           6800        80.5245     14.2504     11.5115         748.541       
[J     total [######............................................] 12.18%
this epoch [####..............................................]  8.77%
      6800 iter, 6 epoch / 50 epochs
    9.1573 iters/sec. Estimated time to finish: 1:29:16.401320.
[4A[J6           6900        80.7877     14.2536                     758.981       
[J     total [######............................................] 12.35%
this epoch [########..........................................] 17.73%
      6900 iter, 6 epoch / 50 epochs
    9.1632 iters/sec. Estimated time to finish: 1:29:02.025871.
[4A[J6           7000        84.0414     13.7874                     769.715       
[J     total [######............................................] 12.53%
this epoch [#############.....................................] 26.68%
      7000 iter, 6 epoch / 50 epochs
    9.1654 iters/sec. Estimated time to finish: 1:28:49.842097.
[4A[J6           7100        89.2334     13.6549                     780.938       
[J     total [######............................................] 12.71%
this epoch [#################.................................] 35.63%
      7100 iter, 6 epoch / 50 epochs
    9.1616 iters/sec. Estimated time to finish: 1:28:41.107269.
[4A[J6           7200        86.9936     14.0124                     792.21        
[J     total [######............................................] 12.89%
this epoch [######################............................] 44.58%
      7200 iter, 6 epoch / 50 epochs
    9.1574 iters/sec. Estimated time to finish: 1:28:32.638431.
[4A[J6           7300        81.7342     14.0162                     802.636       
[J     total [######............................................] 13.07%
this epoch [##########################........................] 53.54%
      7300 iter, 6 epoch / 50 epochs
    9.1632 iters/sec. Estimated time to finish: 1:28:18.395175.
[4A[J6           7400        85.2809     13.9501                     813.178       
[J     total [######............................................] 13.25%
this epoch [###############################...................] 62.49%
      7400 iter, 6 epoch / 50 epochs
    9.1674 iters/sec. Estimated time to finish: 1:28:05.003215.
[4A[J6           7500        80.4841     13.8634                     823.444       
[J     total [######............................................] 13.43%
this epoch [###################################...............] 71.44%
      7500 iter, 6 epoch / 50 epochs
    9.1747 iters/sec. Estimated time to finish: 1:27:49.906563.
[4A[J6           7600        83.2645     13.9155                     833.79        
[J     total [######............................................] 13.61%
this epoch [########################################..........] 80.39%
      7600 iter, 6 epoch / 50 epochs
    9.1805 iters/sec. Estimated time to finish: 1:27:35.696728.
[4A[J6           7700        89.1251     13.6447                     844.927       
[J     total [######............................................] 13.79%
this epoch [############################################......] 89.35%
      7700 iter, 6 epoch / 50 epochs
    9.1782 iters/sec. Estimated time to finish: 1:27:26.103455.
[4A[J6           7800        84.1987     13.7739                     855.881       
[J     total [######............................................] 13.97%
this epoch [#################################################.] 98.30%
      7800 iter, 6 epoch / 50 epochs
    9.1776 iters/sec. Estimated time to finish: 1:27:15.578922.
[4A2024-07-16 16:15:11,523 (lm_utils:255) INFO: best model is rnnlm.model.7
[J7           7900        83.5953     13.977      10.661          868.274       
[J     total [#######...........................................] 14.15%
this epoch [###...............................................]  7.25%
      7900 iter, 7 epoch / 50 epochs
    9.1615 iters/sec. Estimated time to finish: 1:27:13.880590.
[4A[J7           8000        76.6123     13.7708                     878.559       
[J     total [#######...........................................] 14.32%
this epoch [########..........................................] 16.20%
      8000 iter, 7 epoch / 50 epochs
    9.1682 iters/sec. Estimated time to finish: 1:26:59.148286.
[4A[J7           8100        85.5547     13.4345                     889.454       
[J     total [#######...........................................] 14.50%
this epoch [############......................................] 25.16%
      8100 iter, 7 epoch / 50 epochs
    9.1683 iters/sec. Estimated time to finish: 1:26:48.171007.
[4A[J7           8200        86.9753     13.1399                     900.638       
[J     total [#######...........................................] 14.68%
this epoch [#################.................................] 34.11%
      8200 iter, 7 epoch / 50 epochs
    9.1654 iters/sec. Estimated time to finish: 1:26:38.885026.
[4A[J7           8300        86.2207     13.7668                     912.042       
[J     total [#######...........................................] 14.86%
this epoch [#####################.............................] 43.06%
      8300 iter, 7 epoch / 50 epochs
    9.1604 iters/sec. Estimated time to finish: 1:26:30.838022.
[4A[J7           8400        79.5017     13.5676                     922.324       
[J     total [#######...........................................] 15.04%
this epoch [##########################........................] 52.01%
      8400 iter, 7 epoch / 50 epochs
    9.1668 iters/sec. Estimated time to finish: 1:26:16.294239.
[4A[J7           8500        84.7712     13.9257                     932.886       
[J     total [#######...........................................] 15.22%
this epoch [##############################....................] 60.97%
      8500 iter, 7 epoch / 50 epochs
    9.1703 iters/sec. Estimated time to finish: 1:26:03.434651.
[4A[J7           8600        81.6142     13.2857                     943.36        
[J     total [#######...........................................] 15.40%
this epoch [##################################................] 69.92%
      8600 iter, 7 epoch / 50 epochs
    9.1745 iters/sec. Estimated time to finish: 1:25:50.129888.
[4A[J7           8700        80.4977     13.7373                     953.58        
[J     total [#######...........................................] 15.58%
this epoch [#######################################...........] 78.87%
      8700 iter, 7 epoch / 50 epochs
    9.1812 iters/sec. Estimated time to finish: 1:25:35.506108.
[4A[J7           8800        90.2674     13.2572                     964.857       
[J     total [#######...........................................] 15.76%
this epoch [###########################################.......] 87.82%
      8800 iter, 7 epoch / 50 epochs
    9.1774 iters/sec. Estimated time to finish: 1:25:26.707665.
[4A[J7           8900        79.5017     13.5983                     975.328       
[J     total [#######...........................................] 15.94%
this epoch [################################################..] 96.78%
      8900 iter, 7 epoch / 50 epochs
    9.1815 iters/sec. Estimated time to finish: 1:25:13.529057.
[4A[J8           9000        87.3076     13.6099     10.9963         988.213       
[J     total [########..........................................] 16.11%
this epoch [##................................................]  5.73%
      9000 iter, 8 epoch / 50 epochs
    9.1627 iters/sec. Estimated time to finish: 1:25:13.136525.
[4A[J8           9100        75.435      13.4736                     998.34        
[J     total [########..........................................] 16.29%
this epoch [#######...........................................] 14.68%
      9100 iter, 8 epoch / 50 epochs
      9.17 iters/sec. Estimated time to finish: 1:24:58.127922.
[4A[J8           9200        83.5915     13.2093                     1009.17       
[J     total [########..........................................] 16.47%
this epoch [###########.......................................] 23.63%
      9200 iter, 8 epoch / 50 epochs
    9.1707 iters/sec. Estimated time to finish: 1:24:46.880106.
[4A[J8           9300        87.2546     12.7851                     1020.31       
[J     total [########..........................................] 16.65%
this epoch [################..................................] 32.59%
      9300 iter, 8 epoch / 50 epochs
    9.1685 iters/sec. Estimated time to finish: 1:24:37.149213.
[4A[J8           9400        84.9742     13.5346                     1031.64       
[J     total [########..........................................] 16.83%
this epoch [####################..............................] 41.54%
      9400 iter, 8 epoch / 50 epochs
    9.1647 iters/sec. Estimated time to finish: 1:24:28.337312.
[4A[J8           9500        79.5072     13.1284                     1042.11       
[J     total [########..........................................] 17.01%
this epoch [#########################.........................] 50.49%
      9500 iter, 8 epoch / 50 epochs
    9.1687 iters/sec. Estimated time to finish: 1:24:15.242215.
[4A[J8           9600        81.4524     13.5476                     1052.43       
[J     total [########..........................................] 17.19%
this epoch [#############################.....................] 59.44%
      9600 iter, 8 epoch / 50 epochs
    9.1739 iters/sec. Estimated time to finish: 1:24:01.471256.
[4A[J8           9700        83.9792     13.1218                     1063.04       
[J     total [########..........................................] 17.37%
this epoch [##################################................] 68.40%
      9700 iter, 8 epoch / 50 epochs
    9.1764 iters/sec. Estimated time to finish: 1:23:49.185685.
[4A[J8           9800        76.5315     13.4456                     1072.9        
[J     total [########..........................................] 17.55%
this epoch [######################################............] 77.35%
      9800 iter, 8 epoch / 50 epochs
    9.1855 iters/sec. Estimated time to finish: 1:23:33.360796.
[4A[J8           9900        87.0346     12.9371                     1083.91       
[J     total [########..........................................] 17.73%
this epoch [###########################################.......] 86.30%
      9900 iter, 8 epoch / 50 epochs
    9.1844 iters/sec. Estimated time to finish: 1:23:23.056096.
[4A[J8           10000       86.1667     13.5203                     1095          
[J     total [########..........................................] 17.91%
this epoch [###############################################...] 95.26%
     10000 iter, 8 epoch / 50 epochs
    9.1826 iters/sec. Estimated time to finish: 1:23:13.123198.
[4A[J9           10100       82.1733     13.1261     11.5458         1107.67       
[J     total [#########.........................................] 18.08%
this epoch [##................................................]  4.21%
     10100 iter, 9 epoch / 50 epochs
    9.1677 iters/sec. Estimated time to finish: 1:23:10.352463.
[4A[J9           10200       77.4417     13.458                      1117.99       
[J     total [#########.........................................] 18.26%
this epoch [######............................................] 13.16%
     10200 iter, 9 epoch / 50 epochs
    9.1688 iters/sec. Estimated time to finish: 1:22:58.821368.
[4A[J9           10300       82.7611     12.8481                     1128.94       
[J     total [#########.........................................] 18.44%
this epoch [###########.......................................] 22.11%
     10300 iter, 9 epoch / 50 epochs
    9.1664 iters/sec. Estimated time to finish: 1:22:49.235522.
[4A[J9           10400       79.5049     12.8168                     1139.62       
[J     total [#########.........................................] 18.62%
this epoch [###############...................................] 31.07%
     10400 iter, 9 epoch / 50 epochs
    9.1706 iters/sec. Estimated time to finish: 1:22:36.054389.
[4A[J9           10500       88.0708     12.8692                     1151.3        
[J     total [#########.........................................] 18.80%
this epoch [####################..............................] 40.02%
     10500 iter, 9 epoch / 50 epochs
    9.1667 iters/sec. Estimated time to finish: 1:22:27.280587.
[4A[J9           10600       83.7142     13.1545                     1162.46       
[J     total [#########.........................................] 18.98%
this epoch [########################..........................] 48.97%
     10600 iter, 9 epoch / 50 epochs
    9.1618 iters/sec. Estimated time to finish: 1:22:18.979178.
[4A[J9           10700       79.8205     13.1839                     1172.76       
[J     total [#########.........................................] 19.16%
this epoch [############################......................] 57.92%
     10700 iter, 9 epoch / 50 epochs
    9.1636 iters/sec. Estimated time to finish: 1:22:07.088490.
[4A[J9           10800       83.6222     13.0686                     1183.63       
[J     total [#########.........................................] 19.34%
this epoch [#################################.................] 66.88%
     10800 iter, 9 epoch / 50 epochs
    9.1589 iters/sec. Estimated time to finish: 1:21:58.738184.
[4A[J9           10900       73.7436     12.9569                     1193.4        
[J     total [#########.........................................] 19.52%
this epoch [#####################################.............] 75.83%
     10900 iter, 9 epoch / 50 epochs
    9.1657 iters/sec. Estimated time to finish: 1:21:44.134807.
[4A[J9           11000       86.4117     13.0007                     1204.47       
[J     total [#########.........................................] 19.70%
this epoch [##########################################........] 84.78%
     11000 iter, 9 epoch / 50 epochs
     9.166 iters/sec. Estimated time to finish: 1:21:33.106837.
[4A[J9           11100       88.6904     12.9908                     1216.02       
[J     total [#########.........................................] 19.87%
this epoch [##############################################....] 93.73%
     11100 iter, 9 epoch / 50 epochs
    9.1647 iters/sec. Estimated time to finish: 1:21:22.870930.
[4A[J2024-07-16 16:21:17,711 (train_utils:14) WARNING: Hit early stop at epoch 10
You can change the patience or set it to 0 to run all epochs
2024-07-16 16:21:17,711 (lm:392) INFO: test the best model
0it [00:00, ?it/s]5066it [00:00, 74945.57it/s]
2024-07-16 16:21:17,851 (lm:396) INFO: #sentences in the test data = 5066
2024-07-16 16:21:17,851 (lm:397) INFO: #tokens in the test data = 140395
2024-07-16 16:21:17,851 (lm:398) INFO: oov rate in the test data = 0.00 %
2024-07-16 16:21:19,251 (lm:407) INFO: test perplexity: 9.733708449487263
# Accounting: time=1303 threads=1
# Ended (code 0) at Tue Jul 16 16:21:20 CEST 2024, elapsed time 1303 seconds
